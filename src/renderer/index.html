<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Electron</title>
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; font-src 'self' https://cdnjs.cloudflare.com; img-src 'self' data:"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link href="./assets/main.css" type="text/css" rel="stylesheet" />
  </head>

  <body>
    <div class="app-layout">
      <aside class="sidebar">
        <div class="sidebar-header">
          <p class="menu-label">MENU</p>
        </div>

        <nav class="nav-menu">
          <button class="nav-item active" data-target="page-generator">
            <i class="fa-solid fa-wand-magic-sparkles"></i>
            <span>Generator</span>
          </button>

          <button class="nav-item" data-target="page-library">
            <i class="fa-solid fa-book-open"></i>
            <span>Library</span>
          </button>

          <button class="nav-item" data-target="page-history">
            <i class="fa-solid fa-clock-rotate-left"></i>
            <span>History</span>
          </button>

          <button class="nav-item" data-target="page-settings">
            <i class="fa-solid fa-sliders"></i>
            <span>Settings</span>
          </button>
        </nav>

        <footer class="sidebar-footer">
          <div class="version-badge">v<span id="appVersion">2.2.2</span></div>
        </footer>
      </aside>

      <main class="content-view">
        <section id="page-generator" class="view active">
          <div class="view-header">
            <h2>New Project</h2>
            <p class="description">Configure your story settings and launch the AI.</p>
          </div>

          <div class="generator-container">
            <div class="step-card">
              <div class="step-header">
                <div class="step-badge">1</div>
                <h3>Project Basics</h3>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>Project Name (Folder)</label>
                  <input type="text" id="projectName" placeholder="e.g. Mystery_01" />
                </div>
                <div class="form-group">
                  <label>Story Title</label>
                  <input type="text" id="storyTitle" placeholder="The Dark Forest..." />
                </div>
                <div class="form-group">
                  <label>Target Length (Chars)</label>
                  <input type="number" id="storyLength" value="25000" step="1000" />
                </div>
              </div>
            </div>

            <div class="step-card">
              <div class="step-header">
                <div class="step-badge">2</div>
                <h3>Audio Settings</h3>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>Language</label>
                  <select id="language">
                    <option value="English">ðŸ‡ºðŸ‡¸ English</option>
                    <option value="German">ðŸ‡©ðŸ‡ª German</option>
                    <option value="Spanish">ðŸ‡ªðŸ‡¸ Spanish</option>
                    <option value="Ukrainian">ðŸ‡ºðŸ‡¦ Ukrainian</option>
                    <option value="French">ðŸ‡«ðŸ‡· French</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Voice Speaker</label>
                  <select id="voice">
                    <option>Loading...</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="step-card full-height">
              <div class="step-header">
                <div class="step-badge">3</div>
                <h3>Select Story Template</h3>
              </div>
              <div id="templates-container" class="templates-grid">
                <p class="empty-msg">No templates loaded. Check Library.</p>
              </div>
              <input type="hidden" id="selectedTemplate" />
            </div>

            <div class="step-card full-height">
              <div class="step-header">
                <div class="step-badge">4</div>
                <h3>Select SEO Template</h3>
              </div>
              <div id="seo-templates-container" class="templates-grid">
                <p class="empty-msg">No SEO templates loaded.</p>
              </div>
              <input type="hidden" id="selectedSeoTemplate" />
            </div>
            <div class="step-card full-height">
              <div class="step-header">
                <div class="step-badge">5</div>
                <h3>Visual Settings</h3>
              </div>

              <div class="form-group" style="padding: 0 15px; margin-bottom: 15px">
                <label>Total Images</label>
                <input type="number" id="totalImagesCount" value="15" min="1" max="100" />
              </div>

              <div class="step-header" style="border: none; padding-top: 0; padding-bottom: 5px">
                <h4 style="font-size: 12px; color: #888; text-transform: uppercase">
                  Select Style Template
                </h4>
              </div>

              <div id="image-templates-container" class="templates-grid" style="height: 180px">
                <p class="empty-msg">No styles loaded.</p>
              </div>
              <input type="hidden" id="selectedImageTemplate" />
            </div>
          </div>

          <div class="generator-actions">
            <button id="btnStart" class="btn-primary btn-cta">
              <i class="fa-solid fa-rocket"></i>
              <span>Start Generation</span>
            </button>
            <span id="status-line">Ready</span>
          </div>
        </section>

        <section id="page-library" class="view">
          <div class="view-header">
            <h2>Library Manager</h2>
            <p class="description">Manage your voices, story prompts and SEO templates.</p>
          </div>

          <div class="library-tabs">
            <button class="lib-tab-btn active" data-lib-target="lib-voices">
              <i class="fa-solid fa-microphone"></i> Voices
            </button>
            <button class="lib-tab-btn" data-lib-target="lib-stories">
              <i class="fa-solid fa-file-code"></i> Story Prompts
            </button>
            <button class="lib-tab-btn" data-lib-target="lib-seo">
              <i class="fa-solid fa-magnifying-glass-chart"></i> SEO Prompts
            </button>
            <button class="lib-tab-btn" data-lib-target="lib-images">
              <i class="fa-solid fa-image"></i> Image Styles
            </button>
          </div>

          <div class="library-content-container">
            <div id="lib-voices" class="lib-panel active">
              <div class="library-grid-layout" style="grid-template-columns: 1fr">
                <div class="panel voice-panel">
                  <div class="panel-body">
                    <div class="add-voice-form">
                      <div class="input-row">
                        <select
                          id="favVoiceService"
                          class="input-sm"
                          style="width: 100px; margin-right: 5px"
                        >
                          <option value="genai">GenAI</option>
                          <option value="11labs">11 Labs</option>
                        </select>

                        <input
                          type="text"
                          id="favVoiceName"
                          placeholder="Name"
                          class="input-sm flex-grow"
                        />
                        <select id="favVoiceLang" class="input-sm" style="width: 80px">
                          <option value="en">EN</option>
                          <option value="uk">UA</option>
                          <option value="es">ES</option>
                          <option value="de">DE</option>
                        </select>
                        <input
                          type="text"
                          id="favVoiceIdInput"
                          placeholder="Voice ID"
                          class="input-sm flex-grow"
                        />
                        <button id="btnAddFavorite" class="btn-icon primary">
                          <i class="fa-solid fa-plus"></i>
                        </button>
                      </div>
                    </div>
                    <div class="scroll-list">
                      <ul id="favoritesList" class="voice-list"></ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div id="lib-stories" class="lib-panel">
              <div class="panel prompt-panel" style="height: 500px">
                <div class="panel-header with-actions">
                  <span>Story Templates</span>
                </div>
                <div class="prompt-editor-container">
                  <div class="prompt-list-col">
                    <button id="btnNewPrompt" class="btn-secondary full-width">+ New Key</button>
                    <ul id="promptKeysList" class="keys-list"></ul>
                  </div>
                  <div class="prompt-edit-col">
                    <div id="editorOverlay" class="overlay">Select a key</div>
                    <div class="editor-toolbar">
                      <input type="text" id="editPromptKey" />
                      <div class="tool-btns">
                        <button id="btnDeletePrompt" class="btn-icon danger">
                          <i class="fa-solid fa-trash"></i>
                        </button>
                        <button id="btnSavePrompt" class="btn-icon primary">
                          <i class="fa-solid fa-floppy-disk"></i>
                        </button>
                      </div>
                    </div>
                    <textarea id="editPromptText"></textarea>
                  </div>
                </div>
              </div>
            </div>

            <div id="lib-seo" class="lib-panel">
              <div class="panel prompt-panel" style="height: 500px">
                <div class="panel-header with-actions">
                  <span>SEO Templates</span>
                </div>
                <div class="prompt-editor-container">
                  <div class="prompt-list-col">
                    <button id="btnNewSeoPrompt" class="btn-secondary full-width">
                      + New SEO Key
                    </button>
                    <ul id="seoPromptKeysList" class="keys-list"></ul>
                  </div>
                  <div class="prompt-edit-col">
                    <div id="seoEditorOverlay" class="overlay">Select an SEO key</div>
                    <div class="editor-toolbar">
                      <input type="text" id="editSeoPromptKey" />
                      <div class="tool-btns">
                        <button id="btnDeleteSeoPrompt" class="btn-icon danger">
                          <i class="fa-solid fa-trash"></i>
                        </button>
                        <button id="btnSaveSeoPrompt" class="btn-icon primary">
                          <i class="fa-solid fa-floppy-disk"></i>
                        </button>
                      </div>
                    </div>
                    <textarea id="editSeoPromptText"></textarea>
                  </div>
                </div>
              </div>
            </div>
            <div id="lib-images" class="lib-panel">
              <div class="panel prompt-panel" style="height: 500px">
                <div class="panel-header with-actions">
                  <span>Image Style Templates</span>
                </div>
                <div class="prompt-editor-container">
                  <div class="prompt-list-col">
                    <button id="btnNewImagePrompt" class="btn-secondary full-width">
                      + New Style
                    </button>
                    <ul id="imagePromptKeysList" class="keys-list"></ul>
                  </div>
                  <div class="prompt-edit-col">
                    <div id="imageEditorOverlay" class="overlay">Select a style key</div>
                    <div class="editor-toolbar">
                      <input
                        type="text"
                        id="editImagePromptKey"
                        placeholder="Key Name (e.g. Horror)"
                      />
                      <div class="tool-btns">
                        <button id="btnDeleteImagePrompt" class="btn-icon danger">
                          <i class="fa-solid fa-trash"></i>
                        </button>
                        <button id="btnSaveImagePrompt" class="btn-icon primary">
                          <i class="fa-solid fa-floppy-disk"></i>
                        </button>
                      </div>
                    </div>
                    <textarea
                      id="editImagePromptText"
                      placeholder="Enter image prompt description..."
                    ></textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section id="page-history" class="view">
          <div
            class="view-header"
            style="display: flex; justify-content: space-between; align-items: center"
          >
            <h2>History</h2>
            <button id="btnClearHistory" class="btn-text">
              <i class="fa-solid fa-trash"></i> Clear
            </button>
          </div>
          <div id="historyList" class="history-grid"></div>
        </section>

        <section id="page-settings" class="view">
          <div class="view-header">
            <h2>Settings</h2>
            <p class="description">Application configuration</p>
          </div>

          <div class="settings-container">
            <div class="settings-group">
              <div class="accordion-trigger">
                <span><i class="fa-solid fa-key"></i> API Credentials</span>
                <i class="fa-solid fa-chevron-down"></i>
              </div>
              <div class="accordion-body">
                <div class="form-group">
                  <label>Gemini API Key</label>
                  <div class="password-wrapper">
                    <input type="password" id="apiKeyInput" />
                    <i class="fa-solid fa-eye toggle-btn" id="btnToggleKey"></i>
                  </div>
                  <button id="btnSaveKey" class="btn-secondary">Save</button>
                </div>

                <div class="form-group mt-2">
                  <label>GenAI Token (Optional)</label>
                  <div class="password-wrapper">
                    <input type="password" id="genAiKeyInput" />
                    <i class="fa-solid fa-eye toggle-btn" id="btnToggleGenAiKey"></i>
                  </div>
                  <button id="btnSaveGenAiKey" class="btn-secondary">Save</button>
                </div>
                <div class="form-group mt-2">
                  <label>11 Labs Audio Key (voiceapi)</label>
                  <div class="password-wrapper">
                    <input type="password" id="elevenLabsAudioKeyInput" />
                    <i class="fa-solid fa-eye toggle-btn" id="btnToggleElevenAudioKey"></i>
                  </div>
                  <button id="btnSaveElevenAudioKey" class="btn-secondary">Save</button>
                </div>

                <div class="form-group mt-2">
                  <label>11 Labs Image Token</label>
                  <div class="password-wrapper">
                    <input type="password" id="elevenLabsImgKeyInput" />
                    <i class="fa-solid fa-eye toggle-btn" id="btnToggleElevenImgKey"></i>
                  </div>
                  <button id="btnSaveElevenLabsImgKey" class="btn-secondary">Save</button>
                </div>
              </div>
            </div>

            <div class="settings-group">
              <div class="accordion-trigger">
                <span><i class="fa-solid fa-folder"></i> Directories & Paths</span>
                <i class="fa-solid fa-chevron-down"></i>
              </div>
              <div class="accordion-body">
                <div class="form-group">
                  <label>Master Library File (.json)</label>
                  <div class="input-row">
                    <input
                      type="text"
                      id="masterLibraryDisplay"
                      readonly
                      placeholder="Select library.json..."
                    />
                    <button id="btnSelectMasterLibrary" class="btn-icon">
                      <i class="fa-solid fa-database"></i>
                    </button>
                  </div>
                </div>
                <div class="form-group mt-2">
                  <label>Output Folder</label>
                  <div class="input-row">
                    <input type="text" id="outputFolderDisplay" readonly />
                    <button id="btnSelectOutput" class="btn-icon">
                      <i class="fa-solid fa-folder"></i>
                    </button>
                  </div>
                </div>

                <div class="form-group">
                  <label>Edge TTS Path</label>
                  <input type="text" id="edgeTtsPathInput" />
                  <button id="btnSaveEdgePath" class="btn-secondary mt-1">Save Path</button>
                </div>

                <div class="form-group mt-2">
                  <label>FFmpeg Path (.exe)</label>
                  <div class="input-row">
                    <input type="text" id="ffmpegPathDisplay" readonly />
                    <button id="btnSelectFFmpeg" class="btn-icon">
                      <i class="fa-solid fa-file-video"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <div class="settings-group">
              <div class="accordion-trigger">
                <span><i class="fa-solid fa-microchip"></i> AI Engine</span>
                <i class="fa-solid fa-chevron-down"></i>
              </div>
              <div class="accordion-body">
                <div class="form-group">
                  <label>TTS Provider</label>
                  <div class="toggle-switch-group" id="tts-toggles">
                    <button class="toggle-option active" data-value="edge">Edge TTS</button>
                    <button class="toggle-option" data-value="genai">GenAI</button>
                    <button class="toggle-option" data-value="11labs">11 Labs Audio</button>
                  </div>
                  <input type="hidden" id="ttsProvider" value="edge" />
                </div>
                <div class="form-group">
                  <label>Gemini Model</label>
                  <select id="modelSelect">
                    <option value="gemini-2.0-flash">Gemini 2.0 Flash</option>
                    <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                    <option value="gemini-1.5-pro">Gemini 1.5 Pro</option>
                    <option value="gemini-1.5-flash">Gemini 1.5 Flash</option>
                  </select>
                </div>
                <div class="form-group mt-2">
                  <label>Image Generation</label>
                  <div class="toggle-switch-group" id="image-toggles">
                    <button class="toggle-option active" data-value="free">
                      Free (Pollinations)
                    </button>
                    <button class="toggle-option" data-value="eleven">11 Labs image</button>
                  </div>
                  <input type="hidden" id="imageProvider" value="free" />
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <div id="toast-container"></div>

    <div id="previewModal" class="modal-backdrop">
      <div class="modal-card" style="width: 600px; max-width: 90%">
        <div class="modal-head">
          <i class="fa-solid fa-pen-to-square"></i>
          <h3>Edit Text Before Audio</h3>
        </div>
        <div class="modal-body" style="text-align: left">
          <p style="margin-bottom: 10px; color: #aaa; font-size: 13px">
            Review the generated story. What you edit here will be spoken.
          </p>
          <textarea
            id="previewTextarea"
            style="
              width: 100%;
              height: 300px;
              background: #111;
              color: #eee;
              border: 1px solid #333;
              padding: 10px;
              resize: vertical;
            "
          ></textarea>
          <div
            id="charCountPreview"
            style="text-align: right; font-size: 11px; color: #888; margin-top: 5px"
          >
            Symbols: 0
          </div>
        </div>
        <div class="modal-foot">
          <button id="btnCancelPreview" class="btn-text">Cancel</button>
          <button id="btnConfirmAudio" class="btn-primary">
            <i class="fa-solid fa-microphone-lines"></i> Generate Audio
          </button>
        </div>
      </div>
    </div>
    <script type="module" src="./src/renderer.js"></script>
  </body>
</html>
